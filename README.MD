## ã‹ãªã‚²ãƒ¼ãƒ 

![logo]('https://dragonir.github.io/kanaApp/assets/images/icon-64x64.png')

> åœ¨çº¿ä½“éªŒåœ°å€ <https://dragonir.github.io/kanaApp/>

## ä»å¼€å‘ä¸€æ¬¾æ—¥è¯­äº”åéŸ³å°æ¸¸æˆè¿‡ç¨‹ä¸­å¯ä»¥å­¦åˆ°å“ªäº›å‰ç«¯çŸ¥è¯†

## èƒŒæ™¯

åœ¨å­¦ä¹ æ—¥è¯­çš„åˆæœŸé˜¶æ®µï¼Œæˆ‘å‘ç°æ—¥è¯­äº”åéŸ³çš„è®°å¿†å¹¶ä¸æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œå¹³å‡åçš„è®°å¿†å°¤å…¶ä»¤äººè´¹ç¥ã€‚è¿™æ—¶æˆ‘æƒ³å¦‚æœæœ‰ä¸€ä¸ªåº”ç”¨å¯ä»¥å……åˆ†åˆ©ç”¨ç¢ç‰‡æ—¶é—´ï¼Œåœ¨åˆä¼‘æˆ–åœ°é“ä¸Šéšæ—¶å¯ä»¥ç»ƒä¹ è¯¥å¤šå¥½ã€‚äºæ˜¯æœéæ•´ä¸ªApp Storeï¼Œå•†åº—çš„è½¯ä»¶ä¸æ˜¯å«æœ‰å†…è´­ã€å¤¹å¸¦å¹¿å‘Šå°±æ˜¯åŠ¨è¾„40Mä»¥ä¸Šï¼Œæ²¡æ‰¾åˆ°ä¸€ä¸ªè‡ªå·±æ»¡æ„çš„åº”ç”¨ã€‚äºæ˜¯æ‰“ç®—è‡ªå·±é€ è½®å­å†™ä¸€ä¸ªï¼Œå› æ­¤æœ‰äº†è¯¥ç½‘é¡µåº”ç”¨å’Œæ–‡ç« çš„äº§ç”Ÿã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä¸»è¦ä»‹ç»è‡ªå·±åœ¨å¼€å‘è¿™ä¸ªåº”ç”¨è¿‡ç¨‹ä¸­çš„æ”¶è·ã€‚

## å®ç°

### æ·±è‰²æ¨¡å¼

### ç¦»çº¿ç¼“å­˜

prefers-color-scheme
prefers-color-scheme CSS åª’ä½“ç‰¹æ€§ç”¨äºæ£€æµ‹ç”¨æˆ·æ˜¯å¦æœ‰å°†ç³»ç»Ÿçš„ä¸»é¢˜è‰²è®¾ç½®ä¸ºäº®è‰²æˆ–è€…æš—è‰²ã€‚

è¯­æ³•
no-preference
è¡¨ç¤ºç³»ç»Ÿæœªå¾—çŸ¥ç”¨æˆ·åœ¨è¿™æ–¹é¢çš„é€‰é¡¹ã€‚åœ¨å¸ƒå°”å€¼ä¸Šä¸‹æ–‡ä¸­ï¼Œå…¶æ‰§è¡Œç»“æœä¸º falseã€‚
light
è¡¨ç¤ºç”¨æˆ·å·²å‘ŠçŸ¥ç³»ç»Ÿä»–ä»¬é€‰æ‹©ä½¿ç”¨æµ…è‰²ä¸»é¢˜çš„ç•Œé¢ã€‚
dark
è¡¨ç¤ºç”¨æˆ·å·²å‘ŠçŸ¥ç³»ç»Ÿä»–ä»¬é€‰æ‹©ä½¿ç”¨æš—è‰²ä¸»é¢˜çš„ç•Œé¢ã€‚
è¯‘è€…æ³¨ï¼šâ€œæœªå¾—çŸ¥â€ã€â€œå·²å‘ŠçŸ¥â€ç­‰ç”¨è¯­ï¼Œè‹±æ–‡åŸæ–‡å¦‚æ­¤ã€‚
â€œæœªå¾—çŸ¥â€å¯ç†è§£ä¸ºï¼šæµè§ˆå™¨çš„å®¿ä¸»ç³»ç»Ÿä¸æ”¯æŒè®¾ç½®ä¸»é¢˜è‰²ï¼Œæˆ–è€…æ”¯æŒä¸»é¢˜è‰²å¹¶é»˜è®¤ä¸º/è¢«è®¾ä¸ºäº†æœªè®¾ç½®/æ— åå¥½ã€‚
â€œå·²å‘ŠçŸ¥â€ä¸ºï¼šæµè§ˆå™¨çš„å®¿ä¸»ç³»ç»Ÿæ”¯æŒè®¾ç½®ä¸»é¢˜è‰²ï¼Œä¸”è¢«è®¾ç½®ä¸ºäº†äº®è‰²æˆ–è€…æš—è‰²ã€‚

ç›®å‰ï¼Œè‹¥ç»“æœä¸º no-preferenceï¼Œæ— æ³•é€šè¿‡æ­¤åª’ä½“ç‰¹æ€§è·çŸ¥å®¿ä¸»ç³»ç»Ÿæ˜¯å¦æ”¯æŒè®¾ç½®ä¸»é¢˜è‰²ï¼Œæˆ–è€…ç”¨æˆ·æ˜¯å¦ä¸»åŠ¨å°†å…¶è®¾ç½®ä¸ºæ— åå¥½ã€‚å‡ºäºéšç§ä¿æŠ¤ç­‰æ–¹é¢çš„è€ƒè™‘ï¼Œç”¨æˆ·æˆ–ç”¨æˆ·ä»£ç†ä¹Ÿå¯èƒ½åœ¨ä¸€äº›æƒ…å†µä¸‹åœ¨æµè§ˆå™¨å†…éƒ¨å°†å…¶è®¾ç½®ä¸º no-preferenceã€‚

æ ·ä¾‹
è¿™ä¸ªä¾‹å­ä½¿ç”¨äº†ä¸€ä¸ªæœ‰é»‘è‰²èƒŒæ™¯å’Œç™½è‰²æ–‡å­—çš„å…ƒç´ ï¼Œå½“ç”¨æˆ·ä½¿ç”¨æµ…è‰²ä¸»é¢˜æ—¶ï¼Œä¼šç¿»è½¬é»‘ç™½é¢œè‰²ã€‚

HTML
<div class="day">Day (initial)</div>
<div class="day light-scheme">Day (changes in light scheme)</div>
<div class="day dark-scheme">Day (changes in dark scheme)</div> <br>

<div class="night">Night (initial)</div>
<div class="night light-scheme">Night (changes in light scheme)</div>
<div class="night dark-scheme">Night (changes in dark scheme)</div>
Copy to Clipboard
CSS
.day   { background: #eee; color: black; }
.night { background: #333; color: white; }

@media (prefers-color-scheme: dark) {
  .day.dark-scheme   { background:  #333; color: white; }
  .night.dark-scheme { background: black; color:  #ddd; }
}

@media (prefers-color-scheme: light) {
  .day.light-scheme   { background: white; color:  #555; }
  .night.light-scheme { background:  #eee; color: black; }
}

.day, .night {
  display: inline-block;
  padding: 1em;
  width: 7em;
  height: 2em;
  vertical-align: middle;
}
Copy to Clipboard


1.2.6 Darkmode.js
GitHub å¼€æºé¡¹ç›® Darkmode.jsï¼Œé€šè¿‡ CSS å±æ€§ mix-blend-mode æš´åŠ›å®ç°æ·±è‰²æ¨¡å¼ï¼Œç°åœ¨å®ƒæœ‰ 2.2k Starã€‚mix-blend-mode æè¿°å½“å‰å…ƒç´ çš„å†…å®¹åº”è¯¥ä¸å½“å‰å…ƒç´ çš„ç›´ç³»çˆ¶å…ƒç´ çš„å†…å®¹å’Œå…ƒç´ çš„èƒŒæ™¯å¦‚ä½•æ··åˆï¼Œå€¼ä¸º difference æ—¶å³â€œåç›¸â€ã€‚

JSåˆ¤æ–­æ·±è‰²æ¨¡å¼
ä½¿ç”¨matchMediaåˆ¤æ–­æ˜¯å¦ç¬¦åˆåª’ä»‹ã€‚
è¿”å›ä¸€ä¸ªMediaQueryListå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å…·æœ‰å±æ€§matcheså’Œmediaï¼Œæ–¹æ³•addListenerå’ŒremoveListenerã€‚
åˆ¤æ–­æ˜¯å¦æ”¯æŒä¸»é¢˜è‰²ï¼š
if (window.matchMedia('(prefers-color-scheme)').media === 'not all') {
  console.log('Browser doesn\'t support dark mode');
}

åˆ¤æ–­æ˜¯å¦å¤„äºæ·±è‰²æ¨¡å¼ï¼š
if(window.matchMedia('(prefers-color-scheme: dark)').matches){
  //...
}

addListeneræ¥æ”¶ä¸€ä¸ªMediaQueryListå¯¹è±¡ä½œä¸ºå‚æ•°ã€‚
ä¸ºæ·±è‰²æ¨¡å¼æ·»åŠ ç›‘å¬å™¨ï¼Œä»¥å“åº”ç³»ç»Ÿåˆ‡æ¢åˆ°æˆ–åˆ‡æ¢å‡ºæ·±è‰²æ¨¡å¼ï¼š
let listeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
      alert('æ‚¨åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼äº†ï¼')
    }
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
      alert('æ‚¨åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼äº†ï¼')
    }
  }
}

window.matchMedia('(prefers-color-scheme: dark)').addListener(listeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(listeners.light)


webç«¯é€‚é…æ·±è‰²æ¨¡å¼çš„ä¸€äº›çš„è®¤è¯†
é¢„è®¡é˜…è¯»æ—¶é—´ï¼š2åˆ†é’Ÿ
ä»‹ç»
æ·±è‰²æ¨¡å¼æ˜¯WWDC(Worldwide Developers Conference 2018æåˆ°ï¼Œ2019æ­£å¼å¼•è¿›çš„çš„ä¸€ä¸ªç³»ç»Ÿçº§çš„feature)ï¼Œè®©æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿå¯¹äºç”¨æˆ·æ›´åŠ å‹å¥½ä¼˜é›…ã€‚

å®è·µ
è¦é€‚é…æ·±è‰²æ¨¡å¼ï¼Œä»£ç å±‚é¢ä¸»è¦åš2ä»¶äº‹æƒ…

å»åˆ¤æ–­å½“å‰ç”¨æˆ·åå¥½è®¾ç½®çš„æ·±è‰²æ¨¡å¼
é’ˆå¯¹æ·±è‰²æ¨¡å¼ï¼Œè°ƒæ•´css
é’ˆå¯¹ç¬¬ä¸€ä»¶äº‹ï¼šåˆ¤æ–­åå¥½
media query æ”¯æŒ prefers-color-schemeè¿™ä¸ªæŸ¥è¯¢ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»»ä½•æ”¯æŒæŸ¥è¯¢çš„åœ°æ–¹ä½¿ç”¨

åœ¨cssä¸­
@media (prefers-color-scheme: dark) {
    :root {
      XXX: YYY
    }
}
jsä¸­
var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
darkQuery.addListener(function(e) {
  window.__setPreferredTheme(e.matches ? 'dark' : 'light')
});
html elementä¸­
<picture>
  <source srcset="mojave-night.jpg" media="(prefers-color-scheme: dark)">
  <img src="mojave-day.jpg">
</picture>
é’ˆå¯¹ç¬¬äºŒä»¶äº‹ï¼šæ”¹å˜css
å¯ä»¥ç¼–è¯‘ä¸¤å¥—cssï¼Œç„¶åä»£ç ä¸­æ ¹æ®matchMediaåˆ¤æ–­çŠ¶æ€ï¼Œç„¶ååŠ è½½/ç§»é™¤darkçš„cssï¼Œä¸€äº›åº“ä¸­ç”¨çš„æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚rsuite
ç›´æ¥ä½¿ç”¨csså˜é‡


  :root {
      color-scheme: light dark;
      --special-text-color: hsla(60, 100%, 50%, 0.5);
      --border-color: black;
  }
  @media (prefers-color-scheme: dark) {
      :root {
          --special-text-color: hsla(60, 50%, 70%, 0.75);
          --border-color: white;
      }
  }
  .special {
      color: var(--special-text-color);
      border: 1px solid var(--border-color);
  }
ç»“åˆcssé¢„å¤„ç†å™¨å’Œcsså˜é‡ï¼Œå‚è€ƒ https://css-tricks.com/difference-between-types-of-css-variables/#article-header-id-4
ç­‰ç­‰ç­‰ç­‰

https://webkit.org/blog/8840/dark-mode-support-in-webkit/



### ç¦»çº¿ç¼“å­˜
https://www.cnblogs.com/yangyangxxb/p/9964959.html
https://zhuanlan.zhihu.com/p/144512343

### æ¨±èŠ±é£˜è½æ•ˆæœ

```html
<div id="petals_container">
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
</div>
```

```css
.petal {
  width: 1rem;
  height: 1rem;
  display: inline-block;
  position: absolute;
  top: -10rem;
  bottom: 0;
  z-index: 150;
}
.petal .rotate {
  animation: driftyRotate 1s infinite both ease-in-out;
  perspective: 1000;
}
.petal .askew {
  background: currentColor;
  transform: skewY(10deg);
  display: block;
  width: 2rem;
  height: 2rem;
  animation: drifty 1s infinite alternate both ease-in-out;
  perspective: 1000;
}
.petal {
  color: rgba(0, 0, 0, 0);
}
.petal:nth-of-type(7n) .askew {
  animation-delay: -.6s;
  animation-duration: 2.25s;
}
.petal:nth-of-type(7n + 1) .askew {
  animation-delay: -.879s;
  animation-duration: 3.5s;
}
.petal:nth-of-type(7n + 2) .askew {
  animation-delay: -.11s;
  animation-duration: 1.95s;
}
.petal:nth-of-type(7n + 3) .askew {
  animation-delay: -.246s;
  animation-duration: .85s;
}
.petal:nth-of-type(7n + 4) .askew {
  animation-delay: -.43s;
  animation-duration: 2.5s;
}
.petal:nth-of-type(7n + 5) .askew {
  animation-delay: -.56s;
  animation-duration: 1.75s;
}
.petal:nth-of-type(7n + 6) .askew {
  animation-delay: -.76s;
  animation-duration: 1.5s;
}
.petal:nth-of-type(9n) .rotate {
  animation-duration: 2s;
}
.petal:nth-of-type(9n + 1) .rotate {
  animation-duration: 2.3s;
}
.petal:nth-of-type(9n + 2) .rotate {
  animation-duration: 1.1s;
}
.petal:nth-of-type(9n + 3) .rotate {
  animation-duration: .75s;
}
.petal:nth-of-type(9n + 4) .rotate {
  animation-duration: 4.3s;
}
.petal:nth-of-type(9n + 5) .rotate {
  animation-duration: 3.05s;
}
.petal:nth-of-type(9n + 6) .rotate {
  animation-duration: 2.76s;
}
.petal:nth-of-type(9n + 7) .rotate {
  animation-duration: 7.6s;
}
.petal:nth-of-type(9n + 8) .rotate {
  animation-duration: 1.78s;
}
@keyframes drifty {
  0% {
    transform: skewY(10deg) translate3d(-250%, 0, 0);
    display: block;
  }
  100% {
    transform: skewY(-12deg) translate3d(250%, 0, 0);
    display: block;
  }
}
@keyframes driftyRotate {
  0% {
    transform: rotateX(0);
    display: block;
  }
  100% {
    transform: rotateX(359deg);
    display: block;
  }
}
```

```js
var petalPlayers = [];
function animatePetals() {
  var petals = document.querySelectorAll('.petal');
  if (!petals[0].animate) {
    var petalsContainer = document.getElementById('petals_container');
    return false;
  }
  for (var i = 0, len = petals.length; i < len; ++i) {
    var petal = petals[i];
    petal.innerHTML = '<div class="rotate"><img src="data:image/png;base64,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" class="askew"></div>';
    var scale = Math.random() * .6 + .2;
    var player = petal.animate([{
        transform: 'translate3d(' + (i / len * 100) + 'vw,0,0) scale(' + scale + ')',
        opacity: scale
      },
      {
        transform: 'translate3d(' + (i / len * 100 + 10) + 'vw,150vh,0) scale(' + scale + ')',
        opacity: 1
      }
    ], {
      duration: Math.random() * 90000 + 8000,
      iterations: Infinity,
      delay: -(Math.random() * 5000)
    });
    petalPlayers.push(player);
  }
}
animatePetals();
```


## TODO

* æ¨±èŠ±æ•ˆæœ
* æ ·å¼ä¼˜åŒ–
* âœ” PWA ä¿å­˜åˆ°æ¡Œé¢
* âœ” æ·±è‰²æµ…è‰²æ¨¡å¼æ›¿æ¢
* ç¤¼ç‚®åº†ç¥æ•ˆæœğŸ‰